diff --git a/node_modules/server-mcp/node_modules/effect/.bun-tag-3bef8faaa24487a8 b/.bun-tag-3bef8faaa24487a8
new file mode 100644
index 0000000000000000000000000000000000000000..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
diff --git a/node_modules/server-mcp/node_modules/effect/.bun-tag-3e75abd7de68446a b/.bun-tag-3e75abd7de68446a
new file mode 100644
index 0000000000000000000000000000000000000000..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
diff --git a/node_modules/server-mcp/node_modules/effect/.bun-tag-48f2c3cd6c718ed1 b/.bun-tag-48f2c3cd6c718ed1
new file mode 100644
index 0000000000000000000000000000000000000000..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
diff --git a/node_modules/server-mcp/node_modules/effect/.bun-tag-591b0532eb504cd4 b/.bun-tag-591b0532eb504cd4
new file mode 100644
index 0000000000000000000000000000000000000000..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
diff --git a/node_modules/server-mcp/node_modules/effect/.bun-tag-b7e4f95e14abf783 b/.bun-tag-b7e4f95e14abf783
new file mode 100644
index 0000000000000000000000000000000000000000..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
diff --git a/node_modules/server-mcp/node_modules/effect/.bun-tag-ee56d2e4f581cc3c b/.bun-tag-ee56d2e4f581cc3c
new file mode 100644
index 0000000000000000000000000000000000000000..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
diff --git a/dist/unstable/ai/McpSchema.js b/dist/unstable/ai/McpSchema.js
index a9b2dfd82aba5cb0e8925cb9db8c8587724e0520..6358ec39724584f624e97a6d6a01145e0afe2423 100644
--- a/dist/unstable/ai/McpSchema.js
+++ b/dist/unstable/ai/McpSchema.js
@@ -539,7 +539,7 @@ export class Resource extends /*#__PURE__*/Schema.Class("@effect/ai/McpSchema/Re
    * This parameter name is reserved by MCP to allow clients and servers to
    * attach additional metadata to resources.
    */
-  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Unknown))
+  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Json))
 }) {}
 /**
  * A template description for resources available on the server.
@@ -579,7 +579,7 @@ export class ResourceTemplate extends /*#__PURE__*/Schema.Class("@effect/ai/McpS
   /**
    * Optional additional metadata for the client.
    */
-  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Unknown))
+  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Json))
 }) {}
 /**
  * The contents of a specific resource or sub-resource.
@@ -599,7 +599,7 @@ export class ResourceContents extends /*#__PURE__*/Schema.Opaque()(/*#__PURE__*/
   /**
    * Optional additional metadata for the client.
    */
-  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Unknown))
+  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Json))
 })) {}
 /**
  * The contents of a text resource, which can be represented as a string.
@@ -1068,7 +1068,7 @@ export class Tool extends /*#__PURE__*/Schema.Class("@effect/ai/McpSchema/Tool")
    * This parameter name is reserved by MCP to allow clients and servers to
    * attach additional metadata to resources.
    */
-  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Unknown))
+  _meta: /*#__PURE__*/optional(/*#__PURE__*/Schema.Record(Schema.String, Schema.Json))
 }) {}
 /**
  * The server's response to a tools/list request from the client.
diff --git a/dist/unstable/ai/McpServer.d.ts b/dist/unstable/ai/McpServer.d.ts
index 79ee560449295f4914e93807c34e14314776f86b..bcb9b813c7b20bd5a4f75982203ffb21b55f462a 100644
--- a/dist/unstable/ai/McpServer.d.ts
+++ b/dist/unstable/ai/McpServer.d.ts
@@ -171,6 +171,9 @@ export declare const layerHttp: (options: {
     readonly name: string;
     readonly version: string;
     readonly path: HttpRouter.PathInput;
+    readonly capabilities?: {
+        readonly extensions?: Readonly<Record<`${string}/${string}`, {}>>;
+    };
 }) => Layer.Layer<McpServer | McpServerClient, never, HttpRouter.HttpRouter>;
 /**
  * Register a `Toolkit` with the `McpServer`.
diff --git a/dist/unstable/ai/McpServer.js b/dist/unstable/ai/McpServer.js
index 3d2aaa7c3a2711d553fd84ecf54c5513da8a7641..f3e0d61b1f7da794fd32facfd7e6099e9a6f01b8 100644
--- a/dist/unstable/ai/McpServer.js
+++ b/dist/unstable/ai/McpServer.js
@@ -360,7 +360,7 @@ export const registerToolkit = /*#__PURE__*/Effect.fnUntraced(function* (toolkit
   const built = yield* toolkit;
   const services = yield* Effect.services();
   for (const tool of Object.values(built.tools)) {
-    const toolMeta = ServiceMap.getOrUndefined(tool.annotations, Tool.Meta);
+    const toolMeta = ServiceMap.getOption(tool.annotations, Tool.Meta).pipe(Option.getOrUndefined);
     const mcpTool = new McpTool({
       name: tool.name,
       description: Tool.getDescription(tool),
@@ -640,7 +640,7 @@ const compileUriTemplate = (segments, ...schemas) => {
     params
   };
 };
-const layerHandlers = serverInfo => ClientRpcs.toLayer(Effect.gen(function* () {
+const layerHandlers = options => ClientRpcs.toLayer(Effect.gen(function* () {
   const server = yield* McpServer;
   let currentLogLevel = yield* CurrentLogLevel;
   return ClientRpcs.of({
@@ -653,6 +653,9 @@ const layerHandlers = serverInfo => ClientRpcs.toLayer(Effect.gen(function* () {
       const capabilities = {
         completions: {}
       };
+      if (options.capabilities?.extensions) {
+        capabilities.extensions = { ...options.capabilities.extensions };
+      }
       if (server.tools.length > 0) {
         capabilities.tools = {
           listChanged: true
@@ -670,11 +673,18 @@ const layerHandlers = serverInfo => ClientRpcs.toLayer(Effect.gen(function* () {
         };
       }
       server.initializedClients.add(clientId);
-      return Effect.succeed({
+      const response = {
         capabilities,
-        serverInfo,
+        serverInfo: {
+          name: options.name,
+          version: options.version
+        },
         protocolVersion: SUPPORTED_PROTOCOL_VERSIONS.includes(requestedVersion) ? requestedVersion : LATEST_PROTOCOL_VERSION
-      });
+      };
+      return Effect.logInfo(`MCP initialize capabilities: ${JSON.stringify({
+        client: params.capabilities,
+        server: capabilities
+      })}`).pipe(Effect.as(response));
     },
     "completion/complete": r => server.completion(r).pipe(Effect.provideService(CurrentLogLevel, currentLogLevel)),
     "logging/setLevel": ({
@@ -717,9 +727,9 @@ const layerHandlers = serverInfo => ClientRpcs.toLayer(Effect.gen(function* () {
       resourceTemplates: server.resourceTemplates
     })),
     "tools/call": r => server.callTool(r).pipe(Effect.provideService(CurrentLogLevel, currentLogLevel)),
-    "tools/list": () => Effect.sync(() => new ListToolsResult({
-      tools: server.tools
-    })),
+        "tools/list": () => Effect.sync(() => new ListToolsResult({
+          tools: server.tools
+        })),
     // Notifications
     "notifications/cancelled": _ => Effect.void,
     "notifications/initialized": _ => Effect.void,
diff --git a/src/unstable/ai/McpServer.ts b/src/unstable/ai/McpServer.ts
index 10cef7f05dccebc2c4aefaff485e88ad190d319f..d90a5a8a7d6433f8642eea41dea7fa96f9893218 100644
--- a/src/unstable/ai/McpServer.ts
+++ b/src/unstable/ai/McpServer.ts
@@ -520,6 +520,9 @@ export const layerHttp = (options: {
   readonly name: string
   readonly version: string
   readonly path: HttpRouter.PathInput
+  readonly capabilities?: {
+    readonly extensions?: Readonly<Record<`${string}/${string}`, {}>>
+  }
 }): Layer.Layer<McpServer | McpServerClient, never, HttpRouter.HttpRouter> =>
   layer(options).pipe(
     Layer.provide(RpcServer.layerProtocolHttp(options)),
@@ -1071,9 +1074,12 @@ const compileUriTemplate = (segments: TemplateStringsArray, ...schemas: Readonly
   } as const
 }
 
-const layerHandlers = (serverInfo: {
+const layerHandlers = (options: {
   readonly name: string
   readonly version: string
+  readonly capabilities?: {
+    readonly extensions?: Readonly<Record<`${string}/${string}`, {}>>
+  }
 }) =>
   ClientRpcs.toLayer(
     Effect.gen(function*() {
@@ -1088,6 +1094,9 @@ const layerHandlers = (serverInfo: {
           const capabilities: Types.DeepMutable<typeof ServerCapabilities.Type> = {
             completions: {}
           }
+          if (options.capabilities?.extensions) {
+            capabilities.extensions = { ...options.capabilities.extensions }
+          }
           if (server.tools.length > 0) {
             capabilities.tools = { listChanged: true }
           }
@@ -1101,13 +1110,22 @@ const layerHandlers = (serverInfo: {
             capabilities.prompts = { listChanged: true }
           }
           server.initializedClients.add(clientId)
-          return Effect.succeed({
+          const response = {
             capabilities,
-            serverInfo,
+            serverInfo: {
+              name: options.name,
+              version: options.version
+            },
             protocolVersion: SUPPORTED_PROTOCOL_VERSIONS.includes(requestedVersion)
               ? requestedVersion
               : LATEST_PROTOCOL_VERSION
-          })
+          }
+          return Effect.logInfo(
+            `MCP initialize capabilities: ${JSON.stringify({
+              client: params.capabilities,
+              server: capabilities
+            })}`
+          ).pipe(Effect.as(response))
         },
         "completion/complete": (r) =>
           server.completion(r).pipe(
